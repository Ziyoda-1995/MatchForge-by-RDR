document.getElementById('file1').addEventListener('change', function(e) {
            handleFileSelect(e, 1);
        });

        document.getElementById('file2').addEventListener('change', function(e) {
            handleFileSelect(e, 2);
        });

        async function handleFileSelect(event, fileNum) {
            const file = event.target.files[0];
            if (!file) return;            // Test ma'lumotlari - 2-jadval (Xo'jalik egalari va oila a'zolari) - 35 ta yozuv
            const testData2 = [
                ['‚Ññ', '–•—û–∂–∞–ª–∏–∫ —ç–≥–∞—Å–∏ / Head of Household / –ì–ª–∞–≤–∞ —Ö–æ–∑—è–π—Å—Ç–≤–∞', '–£—à–±—É —Ö–æ–Ω–∞–¥–æ–Ω–¥–∞ —è—à–æ–≤—á–∏–ª–∞—Ä –§–ò–® (—Ç—û–ª–∏“õ)', 'Family Members', '–ß–ª–µ–Ω—ã —Å–µ–º—å–∏', '–¢—É“ì–∏–ª–≥–∞–Ω –π–∏–ª–∏', '–ü–∞—Å–ø–æ—Ä—Ç —Ä–∞“õ–∞–º–∏', '“ö–∞—Ä–∏–Ω–¥–æ—à–ª–∏–≥–∏', 'Relationship', '–†–æ–¥—Å—Ç–≤–æ', '–Ø—à–∞—à –º–∞–Ω–∑–∏–ª–∏', '–ú–∏–ª–ª–∞—Ç–∏', '–ú–∞—å–ª—É–º–æ—Ç–∏', '–ò—à –∂–æ–π–∏', '–¢–µ–ª–µ—Ñ–æ–Ω', '–û–∏–ª–∞–≤–∏–π –∞—Ö–≤–æ–ª–∏'],
                [1, '–î–∂—É–º–∞–µ–≤ –°–∞–∏–¥“õ—É–ª –•–∞–º—Ä–æ“õ—É–ª–æ–≤–∏—á', '–î–∂—É–º–∞–µ–≤ –°–∞–∏–¥“õ—É–ª –•–∞–º—Ä–æ“õ—É–ª–æ–≤–∏—á', 'Jumaev Saidqul Hamroqulovich', '–î–∂—É–º–∞–µ–≤ –°–∞–∏–¥–∫—É–ª –•–∞–º—Ä–æ–∫—É–ª–æ–≤–∏—á', '05.11.1964', 'AB2714620', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', 'Head', '–ì–ª–∞–≤–∞', '–ë—û–∑—á–∏–ª–∞—Ä 2 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞', '–°–∞–º –ø–∏–≤–æ –∑–∞–≤–æ–¥', '905308600', '–ö–∞–º —Ç–∞—å–º–∏–Ω–ª–∞–Ω–≥–∞–Ω'],
                [2, '–î–∂—É–º–∞–µ–≤ –°–∞–∏–¥“õ—É–ª –•–∞–º—Ä–æ“õ—É–ª–æ–≤–∏—á', '–ò—Å–ª–æ–º–æ–≤–∞ –ú–∞—Ç–ª—É–±–∞ –ê—Å–ª–∞–º–æ–≤–Ω–∞', 'Islomova Matluba Aslamovna', '–ò—Å–ª–æ–º–æ–≤–∞ –ú–∞—Ç–ª—É–±–∞ –ê—Å–ª–∞–º–æ–≤–Ω–∞', '11.12.1963', '–ê–í9383032', '—Ç—É—Ä–º—É—à —û—Ä—Ç–æ“ì–∏', 'Wife', '–ñ–µ–Ω–∞', '–ë—û–∑—á–∏–ª–∞—Ä 2 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞', '—É–π –±–µ–∫–∞—Å–∏', '915309086', '–ø–µ–Ω—Å–∏–æ–Ω–µ—Ä'],
                [3, '–î–∂—É–º–∞–µ–≤ –°–∞–∏–¥“õ—É–ª –•–∞–º—Ä–æ“õ—É–ª–æ–≤–∏—á', '–î–∂—É–º–∞–µ–≤ –°–æ–±–∏—Ç–∂–æ–Ω –°–∞–∏–¥–∫—É–ª–æ–≤–∏—á', 'Jumaev Sobitjon Saidqulovich', '–î–∂—É–º–∞–µ–≤ –°–æ–±–∏—Ç–∂–æ–Ω –°–∞–∏–¥–∫—É–ª–æ–≤–∏—á', '16.03.1994', 'F–ê7395468', '—û“ì–ª–∏', 'Son', <!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MatchForge - Professional Data Comparison Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.4.2/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/papaparse/5.3.2/papaparse.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
        }
        
        .logo-icon {
            font-size: 3em;
            margin-right: 15px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            font-size: 1.2em;
            margin-bottom: 30px;
            font-style: italic;
        }
        
        .upload-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .file-upload {
            border: 3px dashed #667eea;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            background: linear-gradient(45deg, #f8f9ff, #e8ecff);
        }
        
        .file-upload:hover {
            border-color: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .file-upload h3 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        input[type="file"] {
            margin: 10px 0;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            width: 100%;
            font-size: 14px;
        }
        
        .file-support {
            margin-top: 10px;
            padding: 10px;
            background: #e8f5e8;
            border-radius: 5px;
            font-size: 12px;
            color: #155724;
            text-align: center;
        }
        
        .format-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            margin-top: 5px;
        }
        
        .format-badge {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
        }
        
        button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .result-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }
        
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            font-weight: bold;
        }
        
        tr:hover {
            background: #f8f9ff;
        }
        
        .download-btn {
            margin: 10px 5px;
            background: linear-gradient(45deg, #28a745, #20c997);
        }
        
        .download-btn:hover {
            background: linear-gradient(45deg, #20c997, #28a745);
        }
        
        .file-info {
            margin-top: 10px;
            padding: 10px;
            background: #e8f5e8;
            border-radius: 5px;
            font-size: 12px;
            color: #155724;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">
            <div class="logo-icon">‚ö°</div>
            <h1 id="mainTitle">MatchForge</h1>
        </div>
        <p class="subtitle" id="subtitle">Professional Data Comparison & Analysis Tool</p>
        
        <!-- Til tanlash -->
        <div style="text-align: center; margin-bottom: 20px;">
            <div style="background: linear-gradient(45deg, #f8f9ff, #e8ecff); padding: 15px; border-radius: 10px; display: inline-block;">
                <label style="font-weight: bold; margin-right: 10px;" id="langLabel">üåê Til tanlang:</label>
                <select id="languageSelect" onchange="changeLanguage()" style="padding: 8px; border-radius: 5px; border: 2px solid #667eea; font-size: 14px;">
                    <option value="uz">üá∫üáø O'zbekcha</option>
                    <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
                    <option value="en">üá∫üá∏ English</option>
                </select>
            </div>
        </div>
        
        <div class="upload-section">
            <div class="file-upload">
                <h3 id="table1Title">üìã 1-jadval (Jismoniy abonentlar)</h3>
                <input type="file" id="file1" accept=".xlsx,.xls,.csv,.docx,.doc,.txt" />
                <div class="file-support">
                    <div id="supportedFormats1">‚úÖ Qo'llab-quvvatlanadigan formatlar:</div>
                    <div class="format-badges">
                        <span class="format-badge">üìä XLSX</span>
                        <span class="format-badge">üìä XLS</span>
                        <span class="format-badge">üìÑ CSV</span>
                        <span class="format-badge">üìù DOCX</span>
                        <span class="format-badge">üìù DOC</span>
                        <span class="format-badge">üìÑ TXT</span>
                    </div>
                </div>
                <div class="file-info" id="info1" style="display: none;"></div>
            </div>
            
            <div class="file-upload">
                <h3 id="table2Title">üè† 2-jadval (Xo'jalik egalari)</h3>
                <input type="file" id="file2" accept=".xlsx,.xls,.csv,.docx,.doc,.txt" />
                <div class="file-support">
                    <div id="supportedFormats2">‚úÖ Qo'llab-quvvatlanadigan formatlar:</div>
                    <div class="format-badges">
                        <span class="format-badge">üìä XLSX</span>
                        <span class="format-badge">üìä XLS</span>
                        <span class="format-badge">üìÑ CSV</span>
                        <span class="format-badge">üìù DOCX</span>
                        <span class="format-badge">üìù DOC</span>
                        <span class="format-badge">üìÑ TXT</span>
                    </div>
                </div>
                <div class="file-info" id="info2" style="display: none;"></div>
            </div>
        </div>
        
        <div style="text-align: center;">
            <button id="compareBtn" onclick="compareFiles()" disabled>
                <span id="compareBtnText">üîç FAYLLARNI SOLISHTIRISH</span>
            </button>
            <br><br>
            <button id="testBtn" onclick="runTest()" style="background: linear-gradient(45deg, #ff6b6b, #ee5a24);">
                <span id="testBtnText">üéØ TEST REJIMIDA ISHGA TUSHIRISH</span>
            </button>
        </div>
        
        <div id="result" class="result-section" style="display: none;">
            <h3 id="resultTitle">üìä Natijalar</h3>
            <div id="status"></div>
            <div id="downloadSection" style="display: none;">
                <button class="download-btn" onclick="downloadResult()">
                    <span id="downloadBtnText">üì• NATIJANI YUKLASH (Excel)</span>
                </button>
            </div>
            <div id="tableContainer"></div>
        </div>
    </div>

    <script>
        let file1Data = null;
        let file2Data = null;
        let resultData = [];
        let currentLanguage = 'uz';

        // Til ma'lumotlari
        const translations = {
            uz: {
                mainTitle: 'MatchForge',
                subtitle: 'Professional Ma\'lumot Solishtirish va Tahlil Vositasi',
                langLabel: 'üåê Til tanlang:',
                table1Title: 'üìã 1-jadval (Jismoniy abonentlar)',
                table2Title: 'üè† 2-jadval (Xo\'jalik egalari va oila a\'zolari)',
                compareBtnText: 'üîç FAYLLARNI SOLISHTIRISH',
                testBtnText: 'üéØ TEST REJIMIDA ISHGA TUSHIRISH',
                resultTitle: 'üìä Natijalar',
                downloadBtnText: 'üì• NATIJANI YUKLASH (Excel)',
                supportedFormats: '‚úÖ Qo\'llab-quvvatlanadigan formatlar:',
                loadingTest: 'Ko\'proq test ma\'lumotlari yuklanyapti...',
                testLoaded: 'Katta test ma\'lumoti yuklandi! Endi solishtirish boshlanyapti...',
                analysisStarted: 'Tahlil boshlandi',
                successResult: 'MUVAFFAQIYAT: {0} ta umumiy shaxs va oila a\'zosi topildi',
                greatResult: '(Bu juda yaxshi natija! üéâ)',
                noResults: '‚ùå Afsuski, umumiy shaxslar topilmadi. F.I.Sh yozilishi bir xil emasligini tekshiring.',
                analysisResults: 'TAHLIL NATIJALARI:',
                fileLoaded: '‚úÖ Yuklandi: {0} ({1} qator)',
                unsupportedFormat: '‚ùå Qo\'llab-quvvatlanmagan format: {0}',
                fileError: '‚ùå Faylni o\'qishda xatolik: {0}',
                processingFile: '‚è≥ Fayl ishlov berilmoqda...'
            },
            ru: {
                mainTitle: 'MatchForge',
                subtitle: '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö',
                langLabel: 'üåê –í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫:',
                table1Title: 'üìã 1-—Ç–∞–±–ª–∏—Ü–∞ (–§–∏–∑–∏—á–µ—Å–∫–∏–µ –∞–±–æ–Ω–µ–Ω—Ç—ã)',
                table2Title: 'üè† 2-—Ç–∞–±–ª–∏—Ü–∞ (–ì–ª–∞–≤—ã —Ö–æ–∑—è–π—Å—Ç–≤ –∏ —á–ª–µ–Ω—ã —Å–µ–º—å–∏)',
                compareBtnText: 'üîç –°–†–ê–í–ù–ò–¢–¨ –§–ê–ô–õ–´',
                testBtnText: 'üéØ –ó–ê–ü–£–°–¢–ò–¢–¨ –í –¢–ï–°–¢–û–í–û–ú –†–ï–ñ–ò–ú–ï',
                resultTitle: 'üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã',
                downloadBtnText: 'üì• –°–ö–ê–ß–ê–¢–¨ –†–ï–ó–£–õ–¨–¢–ê–¢ (Excel)',
                supportedFormats: '‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:',
                loadingTest: '–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–æ–ª—å—à–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö...',
                testLoaded: '–ë–æ–ª—å—à–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã! –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ...',
                analysisStarted: '–ê–Ω–∞–ª–∏–∑ –Ω–∞—á–∞—Ç',
                successResult: '–£–°–ü–ï–•: –ù–∞–π–¥–µ–Ω–æ {0} –æ–±—â–∏—Ö –ª–∏—Ü –∏ —á–ª–µ–Ω–æ–≤ —Å–µ–º—å–∏',
                greatResult: '(–≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! üéâ)',
                noResults: '‚ùå –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –æ–±—â–∏–µ –ª–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è –§.–ò.–û.',
                analysisResults: '–†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ù–ê–õ–ò–ó–ê:',
                fileLoaded: '‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ: {0} ({1} —Å—Ç—Ä–æ–∫)',
                unsupportedFormat: '‚ùå –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç: {0}',
                fileError: '‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞: {0}',
                processingFile: '‚è≥ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...'
            },
            en: {
                mainTitle: 'MatchForge',
                subtitle: 'Professional Data Comparison & Analysis Tool',
                langLabel: 'üåê Select Language:',
                table1Title: 'üìã Table 1 (Individual Subscribers)',
                table2Title: 'üè† Table 2 (Household Heads and Family Members)',
                compareBtnText: 'üîç COMPARE FILES',
                testBtnText: 'üéØ RUN IN TEST MODE',
                resultTitle: 'üìä Results',
                downloadBtnText: 'üì• DOWNLOAD RESULT (Excel)',
                supportedFormats: '‚úÖ Supported formats:',
                loadingTest: 'Loading more test data...',
                testLoaded: 'Large test data loaded! Starting comparison...',
                analysisStarted: 'Analysis started',
                successResult: 'SUCCESS: Found {0} common persons and family members',
                greatResult: '(This is a great result! üéâ)',
                noResults: '‚ùå Unfortunately, no common persons found. Check if names are written consistently.',
                analysisResults: 'ANALYSIS RESULTS:',
                fileLoaded: '‚úÖ Loaded: {0} ({1} rows)',
                unsupportedFormat: '‚ùå Unsupported format: {0}',
                fileError: '‚ùå File reading error: {0}',
                processingFile: '‚è≥ Processing file...'
            }
        };

        function changeLanguage() {
            currentLanguage = document.getElementById('languageSelect').value;
            updateUI();
        }

        function updateUI() {
            const t = translations[currentLanguage];
            document.getElementById('mainTitle').textContent = t.mainTitle;
            document.getElementById('subtitle').textContent = t.subtitle;
            document.getElementById('langLabel').textContent = t.langLabel;
            document.getElementById('table1Title').textContent = t.table1Title;
            document.getElementById('table2Title').textContent = t.table2Title;
            document.getElementById('compareBtnText').textContent = t.compareBtnText;
            document.getElementById('testBtnText').textContent = t.testBtnText;
            document.getElementById('resultTitle').textContent = t.resultTitle;
            document.getElementById('downloadBtnText').textContent = t.downloadBtnText;
            document.getElementById('supportedFormats1').textContent = t.supportedFormats;
            document.getElementById('supportedFormats2').textContent = t.supportedFormats;
        }

        // Fayl o'qish funksiyasi - ko'p formatlarni qo'llab-quvvatlaydi
        async function readFile(file, fileNum) {
            const fileName = file.name.toLowerCase();
            const fileExtension = fileName.split('.').pop();
            
            showStatus('processingFile', 'info');
            
            try {
                if (fileExtension === 'xlsx' || fileExtension === 'xls') {
                    return await readExcelFile(file);
                } else if (fileExtension === 'csv') {
                    return await readCSVFile(file);
                } else if (fileExtension === 'docx') {
                    return await readWordFile(file);
                } else if (fileExtension === 'txt') {
                    return await readTextFile(file);
                } else {
                    throw new Error(`${fileExtension.toUpperCase()}`);
                }
            } catch (error) {
                if (error.message.includes('xlsx') || error.message.includes('xls') || 
                    error.message.includes('csv') || error.message.includes('docx') || 
                    error.message.includes('txt')) {
                    showStatus('unsupportedFormat', 'error', error.message);
                } else {
                    showStatus('fileError', 'error', error.message);
                }
                return null;
            }
        }

        async function readExcelFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, {type: 'array'});
                        const firstSheetName = workbook.SheetNames[0];
                        const worksheet = workbook.Sheets[firstSheetName];
                        const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
                        resolve(jsonData);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.onerror = () => reject(new Error('Excel faylni o\'qib bo\'lmadi'));
                reader.readAsArrayBuffer(file);
            });
        }

        async function readCSVFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const csvText = e.target.result;
                        const parsed = Papa.parse(csvText, {
                            header: false,
                            dynamicTyping: true,
                            skipEmptyLines: true
                        });
                        resolve(parsed.data);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.onerror = () => reject(new Error('CSV faylni o\'qib bo\'lmadi'));
                reader.readAsText(file, 'UTF-8');
            });
        }

        async function readWordFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = async function(e) {
                    try {
                        const arrayBuffer = e.target.result;
                        const result = await mammoth.extractRawText({arrayBuffer: arrayBuffer});
                        const text = result.value;
                        
                        // Word matnini jadval formatiga aylantirish
                        const lines = text.split('\n').filter(line => line.trim() !== '');
                        const tableData = [];
                        
                        lines.forEach(line => {
                            // Tab yoki bir nechta bo'sh joylar bilan ajratilgan ma'lumotlarni ajratish
                            const cells = line.split(/\t|\s{2,}/).filter(cell => cell.trim() !== '');
                            if (cells.length > 1) {
                                tableData.push(cells);
                            }
                        });
                        
                        if (tableData.length === 0) {
                            // Agar jadval topilmasa, har bir qatorni bitta ustun sifatida qabul qilish
                            lines.forEach(line => {
                                if (line.trim()) {
                                    tableData.push([line.trim()]);
                                }
                            });
                        }
                        
                        resolve(tableData);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.onerror = () => reject(new Error('Word faylni o\'qib bo\'lmadi'));
                reader.readAsArrayBuffer(file);
            });
        }

        async function readTextFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const text = e.target.result;
                        const lines = text.split('\n').filter(line => line.trim() !== '');
                        const tableData = [];
                        
                        lines.forEach(line => {
                            // Tab, vergul yoki bir nechta bo'sh joylar bilan ajratilgan
                            const cells = line.split(/\t|,|\s{2,}/).filter(cell => cell.trim() !== '');
                            if (cells.length > 0) {
                                tableData.push(cells);
                            }
                        });
                        
                        resolve(tableData);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.onerror = () => reject(new Error('Matn faylni o\'qib bo\'lmadi'));
                reader.readAsText(file, 'UTF-8');
            });
        }

        function showStatus(messageKey, type, ...args) {
            const t = translations[currentLanguage];
            let message = t[messageKey] || messageKey;
            
            // Replace placeholders {0}, {1}, etc.
            args.forEach((arg, index) => {
                message = message.replace(`{${index}}`, arg);
            });
            
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        document.getElementById('file1').addEventListener('change', function(e) {
            handleFileSelect(e, 1);
        });

        document.getElementById('file2').addEventListener('change', function(e) {
            handleFileSelect(e, 2);
        });

        function handleFileSelect(event, fileNum) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});

                    if (fileNum === 1) {
                        file1Data = jsonData;
                        document.getElementById('info1').style.display = 'block';
                        document.getElementById('info1').innerHTML = `‚úÖ Yuklandi: ${jsonData.length} qator`;
                    } else {
                        file2Data = jsonData;
                        document.getElementById('info2').style.display = 'block';
                        document.getElementById('info2').innerHTML = `‚úÖ Yuklandi: ${jsonData.length} qator`;
                    }

                    checkFilesReady();
                } catch (error) {
                    showStatus('Excel faylni o\'qishda xatolik yuz berdi: ' + error.message, 'error');
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function checkFilesReady() {
            const compareBtn = document.getElementById('compareBtn');
            if (file1Data && file2Data) {
                compareBtn.disabled = false;
                compareBtn.style.opacity = '1';
            }
        }

        function compareFiles() {
            if (!file1Data || !file2Data) {
                showStatus('Iltimos, ikkala faylni ham yuklang!', 'error');
                return;
            }

            try {
                const totalRows = (file1Data.length - 1) * (file2Data.length - 1);
                if (totalRows > 10000) {
                    showStatus(`‚è≥ Katta ma'lumot tahlil qilinyapti... Bu biroz vaqt olishi mumkin (${file1Data.length - 1} √ó ${file2Data.length - 1} = ${totalRows.toLocaleString()} ta solishtirish)`, 'info');
                } else {
                    showStatus('Fayllar solishtirilmoqda...', 'info');
                }
                
                // Katta ma'lumotlar uchun timeout berish
                setTimeout(() => {
                    // Ma'lumotlarni tayyorlash
                    const table1 = parseTableData(file1Data, 'table1');
                    const table2 = parseTableData(file2Data, 'table2');
                    
                    showStatus(`üìä Tahlil boshlandi: ${table1.length} abonent vs ${table2.length} xo'jalik egasi`, 'info');
                    
                    // Umumiy shaxslarni topish
                    const commonPeople = findCommonPeople(table1, table2);
                    
                    if (commonPeople.length > 0) {
                        let statusMsg = `‚úÖ MUVAFFAQIYAT: ${commonPeople.length} ta umumiy shaxs topildi`;
                        if (commonPeople.length >= 100) {
                            statusMsg += ` (Bu juda yaxshi natija! üéâ)`;
                        }
                        showStatus(statusMsg, 'success');
                        displayResults(commonPeople);
                        document.getElementById('downloadSection').style.display = 'block';
                    } else {
                        showStatus('‚ùå Afsuski, umumiy shaxslar topilmadi. F.I.Sh yozilishi bir xil emasligini tekshiring.', 'info');
                        document.getElementById('downloadSection').style.display = 'none';
                    }
                    
                    resultData = commonPeople;
                }, 100); // Kichik timeout UI ni yangilash uchun
                
            } catch (error) {
                showStatus('‚ùå Solishtirish jarayonida xatolik: ' + error.message, 'error');
            }
        }

        function parseTableData(data, tableType) {
            if (!data || data.length < 2) return [];
            
            const result = [];
            const headers = data[0];
            
            for (let i = 1; i < data.length; i++) {
                const row = data[i];
                const person = {
                    source: tableType,
                    rowData: {}
                };
                
                // Har bir ustunni nomini bilan saqlash
                headers.forEach((header, index) => {
                    person.rowData[header || `Ustun_${index}`] = row[index] || '';
                });
                
                // F.I.Sh ni aniqlash - keng qidiruv
                let fullName = findFullName(person.rowData);
                
                if (fullName && fullName.length > 5) { // Kamida 5 ta belgi
                    person.fullName = fullName;
                    person.searchVariants = generateSearchVariants(fullName);
                    result.push(person);
                }
            }
            
            return result;
        }

        function findFullName(rowData) {
            const namePatterns = [
                // O'zbek tilida
                /—Ñ–∏—à|—Ñ\.–∏\.—à|—Ñ–∞–º–∏–ª–∏—è|–∏—Å–º|nom|name/i,
                // Rus tilida  
                /—Ñ–∏–æ|—Ñ\.–∏\.–æ|—Ñ–∞–º–∏–ª–∏—è|–∏–º—è|–æ—Ç—á–µ—Å—Ç–≤–æ/i,
                // Ingliz tilida
                /full.?name|first.?name|last.?name|surname/i,
                // Umumiy
                /—Ö—û–∂–∞–ª–∏–∫|—ç–≥–∞—Å–∏|–∞–±–æ–Ω–µ–Ω—Ç|person|client/i
            ];
            
            // Avval kalit so'zlar bo'yicha qidirish
            for (let key of Object.keys(rowData)) {
                const value = String(rowData[key]).trim();
                
                for (let pattern of namePatterns) {
                    if (pattern.test(key.toLowerCase()) && value.length > 5) {
                        // Ism-familya ekanligini tekshirish
                        if (isValidName(value)) {
                            return value.toUpperCase();
                        }
                    }
                }
            }
            
            // Agar topilmasa, eng uzun va ism-familyaga o'xshash matnni izlash
            let bestMatch = '';
            for (let key of Object.keys(rowData)) {
                const value = String(rowData[key]).trim();
                if (isValidName(value) && value.length > bestMatch.length) {
                    bestMatch = value;
                }
            }
            
            return bestMatch ? bestMatch.toUpperCase() : '';
        }

        function isValidName(text) {
            if (!text || text.length < 5) return false;
            
            // Ism-familya bo'lishi uchun shartlar
            const hasSpaces = text.includes(' ');
            const hasLetters = /[A-Za-z–ê-–Ø–∞-—è–Å—ë—û“ì“≥“õ—û—Ü—á—à∆íŒ©]/g.test(text);
            const wordsCount = text.split(/\s+/).filter(w => w.length > 1).length;
            const hasNumbers = /\d/.test(text);
            
            // Kamida 2 ta so'z, harflar bor, raqamlar kam
            return hasSpaces && hasLetters && wordsCount >= 2 && !hasNumbers;
        }

        function generateSearchVariants(fullName) {
            const variants = new Set();
            const cleanName = fullName.replace(/[^\w\s\u0400-\u04FF]/g, '').trim();
            
            variants.add(cleanName);
            
            // So'zlar tartibini o'zgartirish
            const words = cleanName.split(/\s+/).filter(w => w.length > 0);
            
            if (words.length >= 1) {
                // Har bir so'zni alohida
                words.forEach(word => {
                    if (word.length > 2) variants.add(word);
                });
                
                // 2 ta so'z kombinatsiyalari
                for (let i = 0; i < words.length; i++) {
                    for (let j = i + 1; j < words.length; j++) {
                        variants.add(`${words[i]} ${words[j]}`);
                        variants.add(`${words[j]} ${words[i]}`);
                    }
                }
                
                // Qisqartmalar va initiallar
                if (words.length >= 2) {
                    const initials = words.map(w => w.charAt(0)).join('');
                    variants.add(initials);
                    
                    // Birinchi so'z + boshqa so'zlarning birinchi harfi
                    for (let i = 0; i < words.length; i++) {
                        const shortened = words[i] + ' ' + 
                            words.slice(i + 1).map(w => w.charAt(0)).join('');
                        if (shortened.trim().length > 2) variants.add(shortened.trim());
                    }
                }
                
                // 3 ta so'z kombinatsiyalari
                if (words.length >= 3) {
                    // Barcha permutatsiyalar
                    const permutations = [
                        [0, 1, 2], [0, 2, 1], [1, 0, 2], 
                        [1, 2, 0], [2, 0, 1], [2, 1, 0]
                    ];
                    
                    permutations.forEach(perm => {
                        if (perm.every(i => i < words.length)) {
                            const combo = perm.map(i => words[i]).join(' ');
                            variants.add(combo);
                        }
                    });
                }
                
                // Latincha va kirillcha variantlar
                variants.add(toLatin(cleanName));
                
                // Fonetik variantlar
                variants.add(toPhonetic(cleanName));
                
                // Qisman variantlar (birinchi 2 ta so'z)
                if (words.length > 2) {
                    variants.add(words.slice(0, 2).join(' '));
                    variants.add(words.slice(-2).join(' '));
                }
            }
            
            // Bo'sh yoki juda qisqa variantlarni olib tashlash
            return Array.from(variants).filter(v => v.length > 1);
        }

        function findCommonPeople(table1, table2) {
            const common = [];
            const processed = new Set(); // Takrorlanishni oldini olish
            
            showStatus('analysisStarted', 'info', table1.length, table2.length);
            
            let totalComparisons = 0;
            let matchesFound = 0;
            
            table1.forEach((person1, index1) => {
                // Progress ko'rsatish
                if (index1 % 100 === 0 && table1.length > 500) {
                    const progress = ((index1 / table1.length) * 100).toFixed(1);
                    showStatus('analysisStarted', 'info', `${progress}% (${matchesFound} ta topildi)`);
                }
                
                table2.forEach((person2, index2) => {
                    totalComparisons++;
                    
                    // Har bir variant bilan solishtirish
                    let isMatch = false;
                    for (let variant1 of person1.searchVariants) {
                        if (isMatch) break;
                        for (let variant2 of person2.searchVariants) {
                            if (compareNames(variant1, variant2)) {
                                isMatch = true;
                                break;
                            }
                        }
                    }
                    
                    if (isMatch) {
                        const matchKey = `${person1.fullName}-${person2.fullName}`;
                        if (!processed.has(matchKey)) {
                            const combinedPerson = {
                                fullName: person1.fullName,
                                table1Data: person1.rowData,
                                table2Data: person2.rowData,
                                matchScore: calculateMatchScore(person1.fullName, person2.fullName)
                            };
                            common.push(combinedPerson);
                            processed.add(matchKey);
                            matchesFound++;
                        }
                    }
                });
            });
            
            // Natijalarni match score bo'yicha tartiblash
            return common.sort((a, b) => b.matchScore - a.matchScore);
        }

        function calculateMatchScore(name1, name2) {
            // Match qanchalik aniq ekanligini baholash (0-100)
            const similarity = calculateSimilarity(name1, name2);
            const wordMatch = wordsMatch(name1, name2) ? 20 : 0;
            const fullMatch = (name1 === name2) ? 30 : 0;
            
            return Math.round(similarity * 50 + wordMatch + fullMatch);
        }

        function compareNames(name1, name2) {
            if (!name1 || !name2) return false;
            
            // Nomlarni tozalash va normallash
            const clean1 = cleanName(name1);
            const clean2 = cleanName(name2);
            
            if (clean1 === clean2) return true;
            
            // 1. To'liq nom solishtirish (99% o'xshashlik ham yetarli)
            if (fullNameMatch(clean1, clean2)) return true;
            
            // 2. So'zlar bo'yicha solishtirish (yumshoqroq shartlar)
            if (wordsMatch(clean1, clean2)) return true;
            
            // 3. Fuzzy matching (pastroq chegara)
            if (fuzzyMatch(clean1, clean2)) return true;
            
            // 4. Initials matching (bosh harflar)
            if (initialsMatch(clean1, clean2)) return true;
            
            // 5. Partial matching (qisman mos kelish)
            if (partialMatch(clean1, clean2)) return true;
            
            // 6. Phonetic matching (tovush o'xshashligi)
            if (phoneticMatch(clean1, clean2)) return true;
            
            // 7. Transliteration matching (lotin-kirill)
            if (transliterationMatch(clean1, clean2)) return true;
            
            return false;
        }

        function cleanName(name) {
            return name
                .replace(/[^\w\s\u0400-\u04FF\u0410-\u044F]/g, '') // faqat harflar va bo'sh joy
                .replace(/\s+/g, ' ') // bir nechta bo'sh joyni bitta qilish
                .trim()
                .toUpperCase();
        }

        function fullNameMatch(name1, name2) {
            // To'liq mos kelish yoki deyarli mos kelish
            if (name1 === name2) return true;
            
            // 95% o'xshashlik ham yetarli
            const similarity = calculateSimilarity(name1, name2);
            return similarity > 0.95;
        }

        function wordsMatch(name1, name2) {
            const words1 = name1.split(/\s+/).filter(w => w.length > 1);
            const words2 = name2.split(/\s+/).filter(w => w.length > 1);
            
            if (words1.length < 1 || words2.length < 1) return false;
            
            let matchCount = 0;
            let totalPossible = Math.max(words1.length, words2.length);
            
            for (let word1 of words1) {
                for (let word2 of words2) {
                    if (wordSimilar(word1, word2)) {
                        matchCount++;
                        break;
                    }
                }
            }
            
            // Kamida 1 ta so'z mos kelishi yetarli (50%+ mos kelish)
            return matchCount >= 1 && (matchCount / totalPossible) >= 0.4;
        }

        function wordSimilar(word1, word2) {
            if (word1 === word2) return true;
            
            // Uzunlik farqini kengaytirish
            if (Math.abs(word1.length - word2.length) > 4) return false;
            
            // O'xshashlik darajasini pasaytirish
            const similarity = calculateSimilarity(word1, word2);
            return similarity > 0.65; // 65% o'xshashlik
        }

        function fuzzyMatch(name1, name2) {
            // Umumiy o'xshashlik darajasini pasaytirish
            const similarity = calculateSimilarity(name1, name2);
            return similarity > 0.7; // 70% o'xshashlik
        }

        function initialsMatch(name1, name2) {
            const words1 = name1.split(/\s+/).filter(w => w.length > 0);
            const words2 = name2.split(/\s+/).filter(w => w.length > 0);
            
            if (words1.length < 1 || words2.length < 1) return false;
            
            // Bosh harflarni olish
            const initials1 = words1.map(w => w.charAt(0)).join('');
            const initials2 = words2.map(w => w.charAt(0)).join('');
            
            // Kamida 1 ta bosh harf mos kelishi yetarli
            let commonInitials = 0;
            for (let char of initials1) {
                if (initials2.includes(char)) {
                    commonInitials++;
                }
            }
            
            return commonInitials >= 1;
        }

        function partialMatch(name1, name2) {
            // Qisman mos kelish - bir nomning ikkinchisida bo'lishi
            const words1 = name1.split(/\s+/).filter(w => w.length > 2);
            const words2 = name2.split(/\s+/).filter(w => w.length > 2);
            
            for (let word1 of words1) {
                for (let word2 of words2) {
                    // Bir so'z ikkinchisining ichida
                    if (word1.includes(word2) || word2.includes(word1)) {
                        if (Math.abs(word1.length - word2.length) <= 3) {
                            return true;
                        }
                    }
                    
                    // Boshlanishi yoki oxiri bir xil
                    if (word1.length > 3 && word2.length > 3) {
                        if (word1.startsWith(word2.substring(0, 3)) || 
                            word2.startsWith(word1.substring(0, 3))) {
                            return true;
                        }
                    }
                }
            }
            
            return false;
        }

        function phoneticMatch(name1, name2) {
            // Tovush o'xshashligi
            const phonetic1 = toPhonetic(name1);
            const phonetic2 = toPhonetic(name2);
            
            return calculateSimilarity(phonetic1, phonetic2) > 0.8;
        }

        function toPhonetic(name) {
            // Tovushli o'xshash harflarni bir xil qilish
            return name
                .replace(/[–ö“ö]/g, 'K')
                .replace(/[–ì“í]/g, 'G')
                .replace(/[–•“≤]/g, 'H')
                .replace(/[–£–é]/g, 'U')
                .replace(/[–ò–ô]/g, 'I')
                .replace(/[–û–Å]/g, 'O')
                .replace(/[–¶–ß]/g, 'C')
                .replace(/[–®–°]/g, 'S')
                .replace(/[–ó–ñ]/g, 'Z')
                .replace(/[–ë–ü]/g, 'B')
                .replace(/[–í–§]/g, 'V')
                .replace(/[–î–¢]/g, 'D')
                .replace(/[–ú–ù]/g, 'M');
        }

        function transliterationMatch(name1, name2) {
            // Lotin-Kirill konversiya
            const latin1 = toLatin(name1);
            const latin2 = toLatin(name2);
            
            if (latin1 === latin2) return true;
            
            return calculateSimilarity(latin1, latin2) > 0.8;
        }

        function toLatin(name) {
            const cyrillicToLatin = {
                '–ê': 'A', '–ë': 'B', '–í': 'V', '–ì': 'G', '–î': 'D', '–ï': 'E', '–Å': 'YO',
                '–ñ': 'J', '–ó': 'Z', '–ò': 'I', '–ô': 'Y', '–ö': 'K', '–õ': 'L', '–ú': 'M',
                '–ù': 'N', '–û': 'O', '–ü': 'P', '–†': 'R', '–°': 'S', '–¢': 'T', '–£': 'U',
                '–§': 'F', '–•': 'H', '–¶': 'TS', '–ß': 'CH', '–®': 'SH', '–©': 'SCH',
                '–™': '', '–´': 'Y', '–¨': '', '–≠': 'E', '–Æ': 'YU', '–Ø': 'YA',
                '–é': 'O', '“ö': 'Q', '“í': 'G', '“≤': 'H'
            };
            
            return name.split('').map(char => cyrillicToLatin[char] || char).join('');
        }

        function calculateSimilarity(str1, str2) {
            // Levenshtein distance asosida o'xshashlik hisoblash
            const longer = str1.length > str2.length ? str1 : str2;
            const shorter = str1.length > str2.length ? str2 : str1;
            
            if (longer.length === 0) return 1.0;
            
            const distance = levenshteinDistance(longer, shorter);
            return (longer.length - distance) / longer.length;
        }

        function levenshteinDistance(str1, str2) {
            const matrix = [];
            
            for (let i = 0; i <= str2.length; i++) {
                matrix[i] = [i];
            }
            
            for (let j = 0; j <= str1.length; j++) {
                matrix[0][j] = j;
            }
            
            for (let i = 1; i <= str2.length; i++) {
                for (let j = 1; j <= str1.length; j++) {
                    if (str2.charAt(i - 1) === str1.charAt(j - 1)) {
                        matrix[i][j] = matrix[i - 1][j - 1];
                    } else {
                        matrix[i][j] = Math.min(
                            matrix[i - 1][j - 1] + 1,
                            matrix[i][j - 1] + 1,
                            matrix[i - 1][j] + 1
                        );
                    }
                }
            }
            
            return matrix[str2.length][str1.length];
        }

        function displayResults(commonPeople) {
            let tableHtml = '<div style="margin-bottom: 20px;">';
            tableHtml += `<div class="status success">üìä <strong>TAHLIL NATIJALARI:</strong><br>`;
            tableHtml += `‚Ä¢ 1-jadvalda: <strong>${file1Data.length - 1}</strong> ta jismoniy abonent<br>`;
            tableHtml += `‚Ä¢ 2-jadvalda: <strong>${file2Data.length - 1}</strong> ta xo'jalik egasi<br>`;
            tableHtml += `‚Ä¢ <strong>Umumiy shaxslar: ${commonPeople.length}</strong> ta<br>`;
            tableHtml += `‚Ä¢ Mos kelish foizi: <strong>${(commonPeople.length / Math.min(file1Data.length - 1, file2Data.length - 1) * 100).toFixed(1)}%</strong></div>`;
            tableHtml += '</div>';
            
            // Agar ko'p natija bo'lsa, faqat birinchi 50 tasini ko'rsatish
            const maxDisplay = 50;
            const displayCount = Math.min(commonPeople.length, maxDisplay);
            const hasMore = commonPeople.length > maxDisplay;
            
            if (hasMore) {
                tableHtml += `<div class="status info">üìã <strong>DIQQAT:</strong> Jami ${commonPeople.length} ta natija topildi. Sahifada birinchi ${maxDisplay} tasini ko'rsatyapmiz. To'liq ro'yxatni Excel faylida ko'rishingiz mumkin.</div>`;
            }
            
            tableHtml += '<table><thead><tr>';
            tableHtml += '<th style="width: 50px;">‚Ññ</th>';
            tableHtml += '<th style="width: 200px;"><strong>üë§ F.I.Sh</strong></th>';
            tableHtml += '<th style="width: 300px;"><strong>üìã 1-jadval (Abonent ma\'lumotlari)</strong></th>';
            tableHtml += '<th style="width: 350px;"><strong>üè† 2-jadval (Xo\'jalik ma\'lumotlari)</strong></th>';
            tableHtml += '</tr></thead><tbody>';
            
            for (let i = 0; i < displayCount; i++) {
                const person = commonPeople[i];
                tableHtml += `<tr style="border-left: 4px solid #667eea;">`;
                tableHtml += `<td style="text-align: center; font-weight: bold; color: #667eea;">${i + 1}</td>`;
                tableHtml += `<td><div style="font-weight: bold; color: #333; font-size: 14px; line-height: 1.4;">${person.fullName}</div></td>`;
                
                // 1-jadval ma'lumotlari
                let table1Info = '<div style="font-size: 12px; line-height: 1.5;">';
                const importantFields1 = ['“≤–∏—Å–æ–± —Ä–∞“õ–∞–º–∏', '–ú–∞“≥–∞–ª–ª–∞', '–ö—û—á–∞', '–£–π', '–°–∞–ª–¥–æ', '–¢–µ–ª–µ—Ñ–æ–Ω'];
                importantFields1.forEach(field => {
                    const value = person.table1Data[field];
                    if (value) {
                        table1Info += `<div><span style="color: #666; font-weight: bold;">${field}:</span> <span style="color: #333;">${value}</span></div>`;
                    }
                });
                table1Info += '</div>';
                tableHtml += `<td>${table1Info}</td>`;
                
                // 2-jadval ma'lumotlari  
                let table2Info = '<div style="font-size: 12px; line-height: 1.5;">';
                const importantFields2 = ['–¢—É“ì–∏–ª–≥–∞–Ω –π–∏–ª–∏', '–ü–∞—Å–ø–æ—Ä—Ç —Ä–∞“õ–∞–º–∏', '–Ø—à–∞—à –º–∞–Ω–∑–∏–ª–∏', '–ú–∏–ª–ª–∞—Ç–∏', '–ú–∞—å–ª—É–º–æ—Ç–∏', '–ò—à –∂–æ–π–∏', '–¢–µ–ª–µ—Ñ–æ–Ω', '–û–∏–ª–∞–≤–∏–π –∞—Ö–≤–æ–ª–∏'];
                importantFields2.forEach(field => {
                    const value = person.table2Data[field];
                    if (value) {
                        let displayValue = value;
                        if (field === '–û–∏–ª–∞–≤–∏–π –∞—Ö–≤–æ–ª–∏' && value.includes('—Ç–∞—å–º–∏–Ω–ª–∞–Ω–≥–∞–Ω')) {
                            displayValue = `<span style="color: #e74c3c; font-weight: bold;">‚ö†Ô∏è ${value}</span>`;
                        }
                        table2Info += `<div><span style="color: #666; font-weight: bold;">${field}:</span> <span style="color: #333;">${displayValue}</span></div>`;
                    }
                });
                table2Info += '</div>';
                tableHtml += `<td>${table2Info}</td>`;
                
                tableHtml += `</tr>`;
            }
            
            if (hasMore) {
                tableHtml += `<tr><td colspan="4" style="text-align: center; padding: 20px; background: #f8f9ff; font-weight: bold; color: #667eea;">... va yana ${commonPeople.length - maxDisplay} ta natija (Excel faylda to'liq ro'yxat)</td></tr>`;
            }
            
            tableHtml += '</tbody></table>';
            document.getElementById('tableContainer').innerHTML = tableHtml;
            document.getElementById('result').style.display = 'block';
        }

        function downloadResult() {
            if (resultData.length === 0) {
                showStatus('Yuklab olish uchun ma\'lumot yo\'q', 'error');
                return;
            }

            try {
                const ws_data = [];
                
                // Sarlavhalar
                const headers = ['‚Ññ', 'F.I.Sh'];
                const table1Headers = Object.keys(resultData[0].table1Data);
                const table2Headers = Object.keys(resultData[0].table2Data);
                
                table1Headers.forEach(header => headers.push(`1-jadval: ${header}`));
                table2Headers.forEach(header => headers.push(`2-jadval: ${header}`));
                
                ws_data.push(headers);
                
                // Ma'lumotlar
                resultData.forEach((person, index) => {
                    const row = [index + 1, person.fullName];
                    
                    table1Headers.forEach(header => {
                        row.push(person.table1Data[header] || '');
                    });
                    
                    table2Headers.forEach(header => {
                        row.push(person.table2Data[header] || '');
                    });
                    
                    ws_data.push(row);
                });

                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet(ws_data);
                XLSX.utils.book_append_sheet(wb, ws, "Umumiy_shaxslar");
                
                XLSX.writeFile(wb, `Umumiy_shaxslar_${new Date().toISOString().slice(0,10)}.xlsx`);
                showStatus('Fayl muvaffaqiyatli yuklandi!', 'success');
                
            } catch (error) {
                showStatus('Faylni yuklashda xatolik: ' + error.message, 'error');
            }
        }

        function showStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        // Test funksiyasi - oila a'zolari bilan
        function runTest() {
            showStatus('loadingTest', 'info');
            
            // Test ma'lumotlari - 1-jadval (Jismoniy abonentlar) - 25 ta yozuv
            const testData1 = [
                ['‚Ññ', '–§.–ò.–® / Full Name / –§.–ò.–û', '“≤–∏—Å–æ–± —Ä–∞“õ–∞–º–∏', 'Account Number', '–ù–æ–º–µ—Ä —Å—á–µ—Ç–∞', '–ú–∞“≥–∞–ª–ª–∞', '–ö—û—á–∞', '–£–π', '–°–∞–ª–¥–æ', '–¢–µ–ª–µ—Ñ–æ–Ω'],
                [724, 'ABDULLAYEV ABDULLO PIRMAXMADOVICH', '105020840550', '105020840550', '105020840550', '–ë—û–∑–∏ –ú–§–ô (1-—Å–µ–∫—Ç–æ—Ä)', '–ë–£–ó–ò', '6', '114000', '901234567'],
                [725, 'ABDULLAYEVA MALIKA ABDULLO QIZI', '105020840551', '105020840551', '105020840551', '–ë—û–∑–∏ –ú–§–ô (1-—Å–µ–∫—Ç–æ—Ä)', '–ë–£–ó–ò', '6', '50000', '901234568'],
                [726, 'ABDULLAYEV SHERMAT AHMADOVICH', '105020840005', '105020840005', '105020840005', '–ë—û–∑–∏ –ú–§–ô (1-—Å–µ–∫—Ç–æ—Ä)', '–ë–£–ó–ò', '5', '220529', '902345678'],
                [727, 'ABDURAHMONOV JAVHAR UMEDOVICH', '105020840251', '105020840251', '105020840251', '–ë—û–∑–∏ –ú–§–ô (1-—Å–µ–∫—Ç–æ—Ä)', '–ë–£–ó–ò', '4', '139659', '903456789'],
                [728, 'ABDURAHMONOVA NIGORA JAVHAR QIZI', '105020840252', '105020840252', '105020840252', '–ë—û–∑–∏ –ú–§–ô (1-—Å–µ–∫—Ç–æ—Ä)', '–ë–£–ó–ò', '4', '75000', '903456788'],
                [729, 'KARIMOV AKBAR ALIEVICH', '105020840100', '105020840100', '105020840100', '–ú–∞—Ä–∫–∞–∑–∏–π –ú–§–ô', '–ù–ê–í–û–ò–ô', '12', '85000', '904567890'],
                [730, 'KARIMOVA ZULFIYA AKBAR QIZI', '105020840101', '105020840101', '105020840101', '–ú–∞—Ä–∫–∞–∑–∏–π –ú–§–ô', '–ù–ê–í–û–ò–ô', '12', '45000', '904567891'],
                [731, '–î–ñ–£–ú–ê–ï–í –°–ê–ò–î“ö–£–õ –•–ê–ú–†–û“ö–£–õ–û–í–ò–ß', '105020840200', '105020840200', '105020840200', '–ë—û–∑–∏ –ú–§–ô (1-—Å–µ–∫—Ç–æ—Ä)', '–ë–é–ó–ß–ò–õ–ê–†', '2', '150000', '905678901'],
                [732, '–ò–°–õ–û–ú–û–í–ê –ú–ê–¢–õ–£–ë–ê –ê–°–õ–ê–ú–û–í–ù–ê', '105020840201', '105020840201', '105020840201', '–ë—û–∑–∏ –ú–§–ô (1-—Å–µ–∫—Ç–æ—Ä)', '–ë–é–ó–ß–ò–õ–ê–†', '2', '80000', '905678902'],
                [733, '–î–ñ–£–ú–ê–ï–í –°–û–ë–ò–¢–ñ–û–ù –°–ê–ò–î–ö–£–õ–û–í–ò–ß', '105020840202', '105020840202', '105020840202', '–ë—û–∑–∏ –ú–§–ô (1-—Å–µ–∫—Ç–æ—Ä)', '–ë–é–ó–ß–ò–õ–ê–†', '2', '60000', '905678903'],
                [734, 'RAHMONOV DILSHOD KARIMOVICH', '105020840300', '105020840300', '105020840300', '–Ø–Ω–≥–∏ –ú–§–ô', '–Ø–ù–ì–ò', '8', '95000', '906789012'],
                [735, 'NAZAROV BOBUR SHUHRATOVICH', '105020840400', '105020840400', '105020840400', '–ú–∞—Ä–∫–∞–∑–∏–π –ú–§–ô', '–ú–ê–†–ö–ê–ó–ò–ô', '15', '180000', '907890123'],
                [736, 'ISMATOV JASUR AKMALOVICH', '105020840500', '105020840500', '105020840500', '–ò–ø–∞–∫ –ô—û–ª–∏ –ú–§–ô', '–ò–ü–ê–ö', '7', '120000', '908901234'],
                [737, 'ISMATOVA FERUZA JASUR QIZI', '105020840501', '105020840501', '105020840501', '–ò–ø–∞–∫ –ô—û–ª–∏ –ú–§–ô', '–ò–ü–ê–ö', '7', '65000', '908901235'],
                [738, 'MAHMUDOV OTABEK RUSTAMOVICH', '105020840600', '105020840600', '105020840600', '–ß–∏–ª–æ–Ω–∑–æ—Ä –ú–§–ô', '–ß–ò–õ–û–ù–ó–û–†', '22', '75000', '909012345'],
                [739, 'MAHMUDOVA GULNORA OTABEK QIZI', '105020840601', '105020840601', '105020840601', '–ß–∏–ª–æ–Ω–∑–æ—Ä –ú–§–ô', '–ß–ò–õ–û–ù–ó–û–†', '22', '55000', '909012346'],
                [740, 'TASHMATOV ELDOR NORMATOVICH', '105020840700', '105020840700', '105020840700', '–Ø–Ω–≥–∏ –ú–§–ô', '–Ø–ù–ì–ò', '11', '200000', '901123456'],
                [741, 'YUSUPOV FARXOD ABDULLAYEVICH', '105020840800', '105020840800', '105020840800', '–ë—û–∑–∏ –ú–§–ô (2-—Å–µ–∫—Ç–æ—Ä)', '–ë–£–ó–ò-2', '3', '165000', '902234567'],
                [742, 'SADIKOV AZIM HAKIMOVICH', '105020840900', '105020840900', '105020840900', '–ú–∞—Ä–∫–∞–∑–∏–π –ú–§–ô', '–ú–ê–†–ö–ê–ó–ò–ô', '9', '90000', '903345678'],
                [743, 'HAMIDOV NODIR SAIDOVICH', '105020841000', '105020841000', '105020841000', '–ò–ø–∞–∫ –ô—û–ª–∏ –ú–§–ô', '–ò–ü–ê–ö', '14', '110000', '904456789'],
                [744, 'UMAROV SARDOR AMINOVICH', '105020841100', '105020841100', '105020841100', '–ß–∏–ª–æ–Ω–∑–æ—Ä –ú–§–ô', '–ß–ò–õ–û–ù–ó–û–†', '18', '135000', '905567890'],
                [745, 'QODIROV JAVLON RUSTAMOVICH', '105020841200', '105020841200', '105020841200', '–Ø–Ω–≥–∏ –ú–§–ô', '–Ø–ù–ì–ò', '25', '88000', '906678901'],
                [746, 'HAYDAROV ANVAR SHUKUROVICH', '105020841300', '105020841300', '105020841300', '–ë—û–∑–∏ –ú–§–ô (1-—Å–µ–∫—Ç–æ—Ä)', '–ë–£–ó–ò', '13', '145000', '907789012'],
                [747, 'MIRZAYEV BEKZOD ALIMOVICH', '105020841400', '105020841400', '105020841400', '–ú–∞—Ä–∫–∞–∑–∏–π –ú–§–ô', '–ú–ê–†–ö–ê–ó–ò–ô', '6', '175000', '908890123'],
                [748, 'ERGASHEV BOBIR MAMADJONOVICH', '105020841500', '105020841500', '105020841500', '–ò–ø–∞–∫ –ô—û–ª–∏ –ú–§–ô', '–ò–ü–ê–ö', '20', '125000', '909901234']
            ];

            // Test ma'lumotlari - 2-jadval (Xo'jalik egalari) - 30 ta yozuv
            const testData2 = [
                ['‚Ññ', '–•—û–∂–∞–ª–∏–∫ —ç–≥–∞—Å–∏–Ω–∏–Ω–≥ —Ñ–∞–º–∏–ª–∏—è—Å–∏, –∏—Å–º–∏, –æ—Ç–∞—Å–∏–Ω–∏–Ω–≥ –∏—Å–º–∏', '–¢—É“ì–∏–ª–≥–∞–Ω –π–∏–ª–∏', '–ü–∞—Å–ø–æ—Ä—Ç —Ä–∞“õ–∞–º–∏', '“ö–∞—Ä–∏–Ω–¥–æ—à–ª–∏–≥–∏', '–Ø—à–∞—à –º–∞–Ω–∑–∏–ª–∏', '–ú–∏–ª–ª–∞—Ç–∏', '–ú–∞—å–ª—É–º–æ—Ç–∏', '–ò—à –∂–æ–π–∏', '–¢–µ–ª–µ—Ñ–æ–Ω', '–û–∏–ª–∞–≤–∏–π –∞—Ö–≤–æ–ª–∏'],
                [1, '–î–∂—É–º–∞–µ–≤ –°–∞–∏–¥“õ—É–ª –•–∞–º—Ä–æ“õ—É–ª–æ–≤–∏—á', '05.11.1964', 'AB2714620', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ë—û–∑—á–∏–ª–∞—Ä 2 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞', '–°–∞–º –ø–∏–≤–æ –∑–∞–≤–æ–¥', '905308600', '–ö–∞–º —Ç–∞—å–º–∏–Ω–ª–∞–Ω–≥–∞–Ω'],
                [2, 'Abdullayev Abdullo Pirmaxmadovich', '12.03.1975', 'AA1234567', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ë—É–∑–∏ 6 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–ü–µ–¥–∞–≥–æ–≥', '901234567', '–û–¥–¥–∏–π'],
                [3, 'Ismatov Jasur Akmalovich', '20.08.1980', 'AB9876543', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ò–ø–∞–∫ 7 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞ –º–∞—Ö—Å—É—Å', '–¢–∏–∫—É–≤—á–∏', '908901234', '–û–¥–¥–∏–π'],
                [4, 'ABDURAHMONOV JAVHAR UMEDOVICH', '15.05.1985', 'AC5555555', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ë—É–∑–∏ 4 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–ú—É“≥–∞–Ω–¥–∏—Å', '903456789', '–û–¥–¥–∏–π'],
                [5, 'Mahmudov Otabek Rustamovich', '10.01.1990', 'AD7777777', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ß–∏–ª–æ–Ω–∑–æ—Ä 22 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞ –º–∞—Ö—Å—É—Å', '“≤–∞–π–¥–æ–≤—á–∏', '909012345', '–û–¥–¥–∏–π'],
                [6, 'Karimov Akbar Alievich', '25.07.1978', 'AE8888888', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ù–∞–≤–æ–∏–π 12 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–¢–∞–±–∏–±', '904567890', '–û–¥–¥–∏–π'],
                [7, 'Rahmonov Dilshod Karimovich', '18.12.1982', 'AF9999999', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–Ø–Ω–≥–∏ 8 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞', '“ö—É—Ä—É–≤—á–∏', '906789012', '–ö–∞–º —Ç–∞—å–º–∏–Ω–ª–∞–Ω–≥–∞–Ω'],
                [8, 'NAZAROV BOBUR SHUHRATOVICH', '08.04.1977', 'AG1111111', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ú–∞—Ä–∫–∞–∑–∏–π 15 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–ú—É“≥–æ—Å–∏–±', '907890123', '–û–¥–¥–∏–π'],
                [9, 'Tashmatov Eldor Normatovich', '30.09.1986', 'AH2222222', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–Ø–Ω–≥–∏ 11 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞ –º–∞—Ö—Å—É—Å', '–≠–ª–µ–∫—Ç—Ä–∏–∫', '901123456', '–û–¥–¥–∏–π'],
                [10, 'YUSUPOV FARXOD ABDULLAYEVICH', '14.06.1981', 'AI3333333', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ë—É–∑–∏-2 3 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–î–∞—Å—Ç—É—Ä—á–∏', '902234567', '–û–¥–¥–∏–π'],
                [11, 'Sadikov Azim Hakimovich', '22.02.1979', 'AJ4444444', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ú–∞—Ä–∫–∞–∑–∏–π 9 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞', '–°–æ—Ç—É–≤—á–∏', '903345678', '–ö–∞–º —Ç–∞—å–º–∏–Ω–ª–∞–Ω–≥–∞–Ω'],
                [12, 'Hamidov Nodir Saidovich', '07.11.1983', 'AK5555555', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ò–ø–∞–∫ 14 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–é“õ–∏—Ç—É–≤—á–∏', '904456789', '–û–¥–¥–∏–π'],
                [13, 'Umarov Sardor Aminovich', '16.08.1976', 'AL6666666', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ß–∏–ª–æ–Ω–∑–æ—Ä 18 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞ –º–∞—Ö—Å—É—Å', '–°–ª–µ—Å–∞—Ä', '905567890', '–û–¥–¥–∏–π'],
                [14, 'QODIROV JAVLON RUSTAMOVICH', '03.01.1988', 'AM7777777', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–Ø–Ω–≥–∏ 25 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞', '–§–µ—Ä–º–µ—Ä', '906678901', '–ö–∞–º —Ç–∞—å–º–∏–Ω–ª–∞–Ω–≥–∞–Ω'],
                [15, 'Haydarov Anvar Shukurovich', '11.10.1984', 'AN8888888', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ë—É–∑–∏ 13 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–ê–¥–≤–æ–∫–∞—Ç', '907789012', '–û–¥–¥–∏–π'],
                [16, 'Mirzayev Bekzod Alimovich', '28.05.1980', 'AO9999999', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ú–∞—Ä–∫–∞–∑–∏–π 6 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç', '908890123', '–û–¥–¥–∏–π'],
                [17, 'ERGASHEV BOBIR MAMADJONOVICH', '19.12.1987', 'AP1111111', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ò–ø–∞–∫ 20 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞ –º–∞—Ö—Å—É—Å', '–û—à–ø–∞–∑', '909901234', '–û–¥–¥–∏–π'],
                [18, 'Normatov Umid Karimovich', '06.03.1985', 'AQ2222222', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ß–∏–ª–æ–Ω–∑–æ—Ä 10 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä', '901012345', '–û–¥–¥–∏–π'],
                [19, 'AHMEDOV ZAFAR HIKMATOVICH', '24.07.1982', 'AR3333333', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–Ø–Ω–≥–∏ 17 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞', '–ß—û–ø–æ–Ω', '902123456', '–ö–∞–º —Ç–∞—å–º–∏–Ω–ª–∞–Ω–≥–∞–Ω'],
                [20, 'Sultanov Jasurbek Nodirbekovich', '13.09.1986', 'AS4444444', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ë—É–∑–∏-2 5 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–ë–∞–Ω–∫–∏—Ä', '903234567', '–û–¥–¥–∏–π'],
                [21, 'Rustamov Sherzod Abdurashidovich', '02.04.1978', 'AT5555555', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ú–∞—Ä–∫–∞–∑–∏–π 19 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–Æ—Ä–∏—Å—Ç', '904345678', '–û–¥–¥–∏–π'],
                [22, 'FAYZULLAYEV OTABEK SOBIRTOVICH', '21.11.1983', 'AU6666666', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ò–ø–∞–∫ 12 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞ –º–∞—Ö—Å—É—Å', '–ë—û—ë“õ—á–∏', '905456789', '–ö–∞–º —Ç–∞—å–º–∏–Ω–ª–∞–Ω–≥–∞–Ω'],
                [23, 'Aminov Davron Shavkatovich', '09.06.1981', 'AV7777777', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ß–∏–ª–æ–Ω–∑–æ—Ä 8 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞', '“ö—É—Ä—É–≤—á–∏', '906567890', '–û–¥–¥–∏–π'],
                [24, 'Baxtiyorov Ulugbek Hamidovich', '17.02.1989', 'AW8888888', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–Ø–Ω–≥–∏ 21 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–ë–æ—à“õ–∞—Ä—É–≤—á–∏', '907678901', '–û–¥–¥–∏–π'],
                [25, 'Holmatov Aziz Rustamovich', '26.08.1987', 'AX9999999', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ë—É–∑–∏ 9 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞ –º–∞—Ö—Å—É—Å', '–ú–µ—Ö–∞–Ω–∏–∫', '908789012', '–û–¥–¥–∏–π'],
                [26, 'Tursunov Sanjar Abdurahmonovich', '15.01.1984', 'AY1111111', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ú–∞—Ä–∫–∞–∑–∏–π 23 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–ò“õ—Ç–∏—Å–æ–¥—á–∏', '909890123', '–û–¥–¥–∏–π'],
                [27, 'Nematov Islom Karimovich', '04.10.1982', 'AZ2222222', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ò–ø–∞–∫ 16 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞', '“ö–∞—Å—Å–æ–±', '901901234', '–ö–∞–º —Ç–∞—å–º–∏–Ω–ª–∞–Ω–≥–∞–Ω'],
                [28, 'Sharipov Alisher Normatovich', '23.12.1985', 'BA3333333', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ß–∏–ª–æ–Ω–∑–æ—Ä 12 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–¢–∞—Ä–∏—Ö—á–∏', '902012345', '–û–¥–¥–∏–π'],
                [29, 'Qurbonov Jamshid Hakimovich', '12.05.1978', 'BB4444444', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–Ø–Ω–≥–∏ 14 —É–π', '–é–∑–±–µ–∫', '–é—Ä—Ç–∞ –º–∞—Ö—Å—É—Å', '–ù–∞“õ“õ–æ—à', '903123456', '–û–¥–¥–∏–π'],
                [30, 'Yo\'ldoshev Dilmurod Shukurovich', '01.07.1981', 'BC5555555', '–•—û–∂–∞–ª–∏–∫ –±–æ—à–ª–∏“ì–∏', '–ë—É–∑–∏-2 11 —É–π', '–é–∑–±–µ–∫', '–û–ª–∏–π', '–§–∞—Ä–º–∞—Ü–µ–≤—Ç', '904234567', '–û–¥–¥–∏–π']
            ];

            // Test ma'lumotlarini o'zgaruvchilarga o'rnatish
            file1Data = testData1;
            file2Data = testData2;

            // Fayl ma'lumotlarini ko'rsatish
            document.getElementById('info1').style.display = 'block';
            document.getElementById('info1').innerHTML = `‚úÖ Test ma'lumoti: ${testData1.length - 1} ta abonent`;
            
            document.getElementById('info2').style.display = 'block';
            document.getElementById('info2').innerHTML = `‚úÖ Test ma'lumoti: ${testData2.length - 1} ta xo'jalik egasi`;

            // Solishtirish tugmasini faollashtirish
            document.getElementById('compareBtn').disabled = false;
            
            showStatus('Katta test ma\'lumoti yuklandi! Endi solishtirish boshlanyapti...', 'success');
            
            // Avtomatik solishtirish
            setTimeout(() => {
                compareFiles();
            }, 1500);
        }
    </script>
</body>
</html>
